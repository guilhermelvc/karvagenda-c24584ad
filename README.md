# KarvAgenda - Sistema de Agendamento White Label

Sistema completo de agendamento profissional desenvolvido em React com Supabase, preparado para personaliza√ß√£o white label e deploy gratuito no GitHub Pages.

![KarvAgenda](https://img.shields.io/badge/Version-1.0.0-blue)
![React](https://img.shields.io/badge/React-18.3.1-61dafb)
![TypeScript](https://img.shields.io/badge/TypeScript-5.5.3-3178c6)
![Supabase](https://img.shields.io/badge/Supabase-PostgreSQL-3ecf8e)

## üöÄ Funcionalidades

### Core Features
- ‚úÖ **Autentica√ß√£o Completa**: Login/cadastro com email/senha e Google OAuth
- ‚úÖ **Dashboard Interativo**: M√©tricas em tempo real, gr√°ficos e estat√≠sticas
- ‚úÖ **Agenda Visual**: Calend√°rio semanal estilo Google Agenda com drag-and-drop
- ‚úÖ **CRUD Completo**: Gerenciamento de clientes, profissionais e servi√ßos
- ‚úÖ **Perfis de Acesso**: Sistema de roles (admin, profissional, cliente)
- ‚úÖ **Modo Claro/Escuro**: Tema personaliz√°vel com paleta profissional
- ‚úÖ **100% Responsivo**: Otimizado para desktop, tablet, mobile e smartwatch

### Integra√ß√µes (Preparado para conectar)
- üì± **WhatsApp Business**: API Evolution para lembretes e notifica√ß√µes autom√°ticas
- ü§ñ **IA Gemini**: Rob√¥ de atendimento com prompt customiz√°vel
- üìÖ **Google Calendar**: Sincroniza√ß√£o bidirecional de agendamentos
- üí≥ **Pagamentos**: Estrutura pronta para integra√ß√£o com gateways

### White Label
- üé® **Personaliza√ß√£o Total**: Logo, cores, slogan e marca pr√≥pria
- üåê **Multi-idioma**: Suporte para Portugu√™s, Ingl√™s e Espanhol
- üìä **Analytics**: Relat√≥rios detalhados e exporta√ß√£o de dados

## üõ†Ô∏è Tecnologias

- **Frontend**: React 18, TypeScript, Vite
- **UI**: Tailwind CSS, shadcn/ui, Radix UI
- **Backend**: Supabase (PostgreSQL, Auth, Storage)
- **Roteamento**: React Router v6
- **Estado**: React Query, Context API
- **Gr√°ficos**: Recharts
- **Datas**: date-fns
- **Deploy**: GitHub Pages

## üì¶ Instala√ß√£o e Configura√ß√£o

### Pr√©-requisitos
- Node.js 18+ e npm/yarn/bun
- Conta no Supabase (gratuita)
- Conta no Google Cloud Console (para OAuth)

### 1. Clone o reposit√≥rio
```bash
git clone https://github.com/seu-usuario/KarvAgenda.git
cd KarvAgenda
```

### 2. Instale as depend√™ncias
```bash
npm install
# ou
yarn install
# ou
bun install
```

### 3. Configure o Supabase

#### 3.1 Crie um projeto no Supabase
- Acesse [supabase.com](https://supabase.com)
- Crie um novo projeto
- Anote a URL e as chaves (anon/public key)

#### 3.2 Configure as vari√°veis de ambiente
As credenciais j√° est√£o configuradas em `src/lib/supabase.ts`. Para usar suas pr√≥prias credenciais:

```typescript
// src/lib/supabase.ts
const supabaseUrl = 'SUA_URL_SUPABASE';
const supabaseAnonKey = 'SUA_CHAVE_PUBLICA';
```

#### 3.3 Execute as migra√ß√µes do banco de dados
Execute os seguintes comandos SQL no SQL Editor do Supabase:

```sql
-- Criar tabela de perfis de usu√°rio
CREATE TABLE public.perfis (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  nome TEXT,
  telefone TEXT,
  avatar_url TEXT,
  tipo_perfil TEXT DEFAULT 'cliente' CHECK (tipo_perfil IN ('admin', 'profissional', 'cliente')),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Habilitar RLS
ALTER TABLE public.perfis ENABLE ROW LEVEL SECURITY;

-- Pol√≠ticas de seguran√ßa
CREATE POLICY "Usu√°rios podem ver seu pr√≥prio perfil"
  ON public.perfis FOR SELECT
  USING (auth.uid() = id);

CREATE POLICY "Usu√°rios podem atualizar seu pr√≥prio perfil"
  ON public.perfis FOR UPDATE
  USING (auth.uid() = id);

-- Trigger para criar perfil automaticamente
CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.perfis (id, nome)
  VALUES (NEW.id, NEW.raw_user_meta_data->>'nome');
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();

-- Criar tabela de clientes
CREATE TABLE public.clientes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  nome TEXT NOT NULL,
  email TEXT NOT NULL,
  telefone TEXT,
  whatsapp TEXT,
  avatar_url TEXT,
  observacoes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

ALTER TABLE public.clientes ENABLE ROW LEVEL SECURITY;

-- Criar tabela de profissionais
CREATE TABLE public.profissionais (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  nome TEXT NOT NULL,
  email TEXT NOT NULL,
  telefone TEXT,
  especialidade TEXT,
  avatar_url TEXT,
  horarios JSONB,
  dias_folga INTEGER[],
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

ALTER TABLE public.profissionais ENABLE ROW LEVEL SECURITY;

-- Criar tabela de servi√ßos
CREATE TABLE public.servicos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  nome TEXT NOT NULL,
  descricao TEXT,
  duracao_minutos INTEGER NOT NULL,
  valor DECIMAL(10,2) NOT NULL,
  categoria TEXT,
  ativo BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

ALTER TABLE public.servicos ENABLE ROW LEVEL SECURITY;

-- Criar tabela de agendamentos
CREATE TABLE public.agendamentos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  cliente_id UUID REFERENCES public.clientes(id) ON DELETE CASCADE,
  profissional_id UUID REFERENCES public.profissionais(id) ON DELETE CASCADE,
  servico_id UUID REFERENCES public.servicos(id) ON DELETE CASCADE,
  data_hora TIMESTAMP WITH TIME ZONE NOT NULL,
  status TEXT DEFAULT 'agendado' CHECK (status IN ('agendado', 'confirmado', 'concluido', 'cancelado')),
  observacoes TEXT,
  avaliacao INTEGER CHECK (avaliacao >= 1 AND avaliacao <= 5),
  comentario_avaliacao TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

ALTER TABLE public.agendamentos ENABLE ROW LEVEL SECURITY;

-- Pol√≠ticas b√°sicas (ajuste conforme necess√°rio)
CREATE POLICY "Clientes podem ver seus agendamentos"
  ON public.agendamentos FOR SELECT
  USING (cliente_id IN (SELECT id FROM public.clientes WHERE user_id = auth.uid()));

CREATE POLICY "Profissionais podem ver seus agendamentos"
  ON public.agendamentos FOR SELECT
  USING (profissional_id IN (SELECT id FROM public.profissionais WHERE user_id = auth.uid()));
```

### 4. Configure Google OAuth

#### 4.1 Google Cloud Console
1. Acesse [console.cloud.google.com](https://console.cloud.google.com)
2. Crie um novo projeto ou selecione um existente
3. Ative a Google+ API
4. Configure a tela de consentimento OAuth
5. Crie credenciais OAuth 2.0:
   - Tipo: Web application
   - Authorized JavaScript origins: `http://localhost:8080` e seu dom√≠nio de produ√ß√£o
   - Authorized redirect URIs: `https://[seu-projeto].supabase.co/auth/v1/callback`

#### 4.2 Configure no Supabase
1. V√° para Authentication > Providers no Supabase
2. Ative o Google provider
3. Cole o Client ID e Client Secret do Google Cloud Console

### 5. Execute o projeto localmente
```bash
npm run dev
# ou
yarn dev
# ou
bun dev
```

Acesse: `http://localhost:8080`

## üöÄ Deploy no GitHub Pages

### 1. Configure o package.json
O projeto j√° est√° configurado com:
```json
{
  "homepage": "https://seu-usuario.github.io/KarvAgenda/",
  "scripts": {
    "predeploy": "npm run build",
    "deploy": "gh-pages -d dist"
  }
}
```

**‚ö†Ô∏è IMPORTANTE**: Atualize o campo `homepage` com seu usu√°rio do GitHub!

### 2. Instale gh-pages (j√° inclu√≠do)
```bash
npm install --save-dev gh-pages
```

### 3. Build e Deploy
```bash
npm run deploy
```

Isso ir√°:
1. Criar o build de produ√ß√£o
2. Criar/atualizar a branch `gh-pages`
3. Fazer push autom√°tico para o GitHub

### 4. Configure o GitHub Pages
1. V√° para Settings > Pages no seu reposit√≥rio
2. Source: Deploy from a branch
3. Branch: `gh-pages` / `root`
4. Salve

Seu site estar√° dispon√≠vel em: `https://seu-usuario.github.io/KarvAgenda/`

### 5. Configura√ß√µes importantes para GitHub Pages

#### Vite Config (j√° configurado)
```typescript
// vite.config.ts
export default defineConfig({
  base: '/KarvAgenda/', // Nome do seu reposit√≥rio
  // ...
});
```

#### Supabase Redirect URLs
Configure no Supabase Dashboard > Authentication > URL Configuration:
- Site URL: `https://seu-usuario.github.io/KarvAgenda/`
- Redirect URLs: Adicione a mesma URL acima

## üåê Migra√ß√£o para Dom√≠nio Pr√≥prio

### Op√ß√£o 1: Custom Domain no GitHub Pages
1. Compre um dom√≠nio (Namecheap, GoDaddy, etc.)
2. Configure DNS records:
   ```
   Type: A
   Name: @
   Value: 185.199.108.153
   Value: 185.199.109.153
   Value: 185.199.110.153
   Value: 185.199.111.153
   
   Type: CNAME
   Name: www
   Value: seu-usuario.github.io
   ```
3. Adicione arquivo `CNAME` na pasta `public/` com seu dom√≠nio
4. Configure no GitHub: Settings > Pages > Custom domain

### Op√ß√£o 2: Hospedagem Pr√≥pria
Para escalar e ter mais controle, considere:

#### Vercel (Recomendado - Gratuito)
```bash
npm install -g vercel
vercel
```

#### Netlify (Gratuito)
```bash
npm install -g netlify-cli
netlify deploy --prod
```

#### AWS Amplify, Render, Railway, etc.
Todos suportam deploy direto do GitHub com CI/CD autom√°tico.

## üîß Configura√ß√£o das Integra√ß√µes

### WhatsApp Business (API Evolution)
```typescript
// Configure em: Configura√ß√µes > WhatsApp
// 1. Obtenha API Key em: https://evolution-api.com
// 2. Configure webhook para receber mensagens
// 3. Ative lembretes autom√°ticos
```

### IA Gemini
```typescript
// Configure em: Configura√ß√µes > IA
// 1. Obtenha API Key: https://makersuite.google.com/app/apikey
// 2. Customize o prompt do assistente
// 3. Ative o atendimento autom√°tico
```

### Google Calendar
```typescript
// 1. Ative Google Calendar API no Cloud Console
// 2. Configure OAuth scope: https://www.googleapis.com/auth/calendar
// 3. Implemente sincroniza√ß√£o bidirecional
```

## üì± White Label - Personaliza√ß√£o

### Alterar Logo e Cores
```typescript
// 1. Upload do logo: Configura√ß√µes > Apar√™ncia
// 2. Escolha cores principais
// 3. Configure slogan e textos
```

### Customizar Paleta de Cores
```css
/* src/index.css */
:root {
  --primary: 217 91% 60%; /* Azul principal */
  --success: 142 71% 45%; /* Verde sucesso */
  --destructive: 0 84% 60%; /* Vermelho a√ß√µes destrutivas */
}
```

## üìä Analytics e Relat√≥rios

O sistema j√° coleta m√©tricas importantes:
- Total de agendamentos
- Taxa de ocupa√ß√£o
- Servi√ßos mais solicitados
- Hor√°rios de pico
- Receita mensal
- Avalia√ß√µes

Para analytics avan√ßado, integre:
- Google Analytics
- Mixpanel
- Amplitude

## üîê Seguran√ßa

- ‚úÖ Row Level Security (RLS) habilitado
- ‚úÖ Autentica√ß√£o JWT via Supabase
- ‚úÖ Valida√ß√£o de dados no frontend e backend
- ‚úÖ HTTPS obrigat√≥rio
- ‚úÖ CORS configurado
- ‚úÖ Sanitiza√ß√£o de inputs

## üêõ Troubleshooting

### Erro de autentica√ß√£o Google
- Verifique se o redirect URI est√° correto no Google Cloud Console
- Confirme que o dom√≠nio est√° autorizado no Supabase

### Erro 404 no refresh no GitHub Pages
Adicione arquivo `404.html` na pasta `public/` com redirecionamento para index.html

### Build falha
```bash
# Limpe cache e reinstale
rm -rf node_modules package-lock.json
npm install
npm run build
```

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas! Para contribuir:

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudan√ßas (`git commit -m 'Add some AmazingFeature'`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

## üìû Suporte

- üìß Email: suporte@karvagenda.com
- üí¨ Discord: [Link do servidor]
- üìñ Documenta√ß√£o: [Link da documenta√ß√£o]

## üéØ Roadmap

- [ ] Integra√ß√£o completa WhatsApp Business
- [ ] Sincroniza√ß√£o Google Calendar
- [ ] Sistema de pagamentos integrado
- [ ] App mobile (React Native)
- [ ] Sistema de fidelidade/pontos
- [ ] Relat√≥rios avan√ßados em PDF
- [ ] Multi-tenancy (SaaS)
- [ ] API p√∫blica para integra√ß√µes

---

Desenvolvido com ‚ù§Ô∏è usando React, TypeScript e Supabase
